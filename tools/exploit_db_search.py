import requests
from langchain_core.tools import tool

API_URL = "http://127.0.0.1:4444"  # TODO CONFIGURE API URL

@tool
def exploitdb_search_tool(query: str) -> str:
    """
    Searches for exploits on Exploit-DB using a keyword or CVE.

    Args:
        query (str): The search term, which can be a keyword or a CVE identifier.

    Returns:
        str: The search results from Exploit-DB.
    """
    try:
        payload = {"command":"searchsploit " + query.strip()}  # Prefix with searchsploit for API compatibility
        response = requests.post(f"{API_URL}/execute", json=payload)
        response.raise_for_status()
        return response.json()  # Assuming the API returns JSON data
    except Exception as e:
        return f"Error during Exploit-DB search: {str(e)}"
    
# print(exploitdb_search_tool.invoke("CVE-2021-34527"))  # Example usage, can be removed later